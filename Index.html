<script>
    let watchedAds = parseInt(localStorage.getItem('watchedAds') || 0);
    let earnedPoints = parseFloat(localStorage.getItem('earnedPoints') || 0.00);

    document.getElementById('watched-ads').textContent = watchedAds;
    document.getElementById('earned-points').textContent = earnedPoints.toFixed(2);
    updateProgressBar();

    document.getElementById('withdraw-btn').addEventListener('click', toggleWithdraw);
    document.getElementById('submit-withdraw').addEventListener('click', withdrawPoints);
    document.getElementById('join-btn').addEventListener('click', function () {
        window.location.href = "https://t.me/earningmoney262";
    });

    // অটো অ্যাড চালানো ফাংশন
    function autoWatchAds() {
        if (typeof show_9092731 === 'function') {
            show_9092731().then(() => {
                watchedAds++;
                earnedPoints += 0.1;

                localStorage.setItem('watchedAds', watchedAds);
                localStorage.setItem('earnedPoints', earnedPoints.toFixed(2));

                document.getElementById('watched-ads').textContent = watchedAds;
                document.getElementById('earned-points').textContent = earnedPoints.toFixed(2);
                updateProgressBar();
            }).catch(err => console.error("Ad failed to load", err));
        } else {
            console.warn("Ad function is not available.");
        }
    }

    function updateProgressBar() {
        const progress = (watchedAds % 20) * 5;
        document.getElementById('progress-circle').style.background = `conic-gradient(#4caf50 ${progress}%, #ccc ${progress}%)`;
        document.getElementById('progress-circle').textContent = `${progress}%`;
    }

    function toggleWithdraw() {
        document.getElementById('withdraw-section').classList.toggle('hidden');
    }

    function withdrawPoints() {
        const amount = parseFloat(document.getElementById('withdraw-amount').value);
        const method = document.getElementById('payment-method').value;
        const phone = document.getElementById('phone-number').value;

        if (amount < 20 || amount > earnedPoints) {
            alert('Invalid withdrawal amount.');
            return;
        }

        earnedPoints -= amount;
        localStorage.setItem('earnedPoints', earnedPoints.toFixed(2));
        document.getElementById('earned-points').textContent = earnedPoints.toFixed(2);

        const message = `Withdrawal Request:\nAmount: ${amount} BDT\nMethod: ${method}\nPhone: ${phone}`;
        sendTelegramMessage(message);
    }

    function sendTelegramMessage(msg) {
        const botToken = "YOUR_BOT_TOKEN";  // টেলিগ্রাম বট টোকেন দিন
        const chatId = "YOUR_CHAT_ID";  // আপনার চ্যাট আইডি দিন

        fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(msg)}`)
            .then(response => response.json())
            .then(data => console.log('Message sent to admin'))
            .catch(error => console.error('Error:', error));
    }

    // এখানে প্রতি ৩০ সেকেন্ডে অটো অ্যাড চালানো হবে
    setInterval(autoWatchAds, 30000); // ৩০ সেকেন্ডে একবার অ্যাড দেখাবে
</script>
